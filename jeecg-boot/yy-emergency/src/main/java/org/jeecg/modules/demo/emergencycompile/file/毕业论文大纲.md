

# 毕业论文大纲

## 摘要

​	随着我国步入“十四五规划”阶段，针对政府治理效能、资源配置及利用效率，有了更高的要求，必须要让效能得到新提升，规划满足合理性。例如，当出现社会突发险情事件时，及时将资源合理调配并投送至相应发生地，采取快速有效的处置措施，减少险情带来的伤亡和损失，对于应急管理部门和救援队伍至关重要。本文针对突发险情事件时效要求高，统筹抢险力量弱、救援力量少、转移避险复杂等核心问题，使用贵阳市公安局，人社局，警备区等政府部门元数据信息搭建数据仓库，结合应急指挥部实际救援需求，设计并实现了突发险情事件应急资源调配规划系统。本系统能够编写且存储险情处置规则，快速解析险情，生成应急处置任务预案，并进行调配应急资源，规划救援方案可视化展示。

​	本文主要研究工作如下：

​	1）通过分析国家突发险情事件应急响应机制，使用基于规则引擎的规则推理（ Rule-Based Reasoning ，RBR ）和案例推理（ Case-Based Reasoning ，CBR ）技术，应用于突发险情事件决策中，使用RBR直接生成救援预案或对CBR生成的预案进行增强。本文提出了突发险情事件决策框架，根据框架中决策流程对险情案例表示、险情案例重用、险情案例优化、险情案例学习分别展开了研究。针对突发险情事件的特点，在险情表示阶段，使用分词与正则表达式技术，对险情事件解析让其结构化，运用面向对象的知识，构造险情对象。接着细化拆分险情应对条件，对险情分配相关子任务。此表示方法可以全面地描述突发险情事件发生情况、救援条件，有利于任务预案生成。在险情重用及优化阶段中，给出了险情相似度计算公式与规则库构建方法，无论对于使用者选择相似推荐，或规则推荐方法生成任务预案，都有着直观快速展示。那么险情学习阶段，对已完成任务预案归纳总结，迭代变化成专家知识内容，满足系统可扩展性、专业性。

​	2）在应急资源调配方面，基于大规模并行处理（ Massively Parallel Processor ，MPP ）数据库技术，依照贵阳市公安局，人社局，警备区等政府多部门数据资源，设计并建立应急资源数据仓库（Data Warehouse， DW）。各部门操作性数据（ Operational Data Store ，ODS ）通过获取、转换、加载（Extract-Transform-Load， ETL） 代码，形成星型模式下维度表与事实表关系。通过数据仓库不同层次之间的加工过程，实现从数据资产向信息资产的转化，能够响应复杂查询情况，高效于应急资源数据存储及可视化展示。	

​	3）在应急资源规划方面，面对多目标点多救援点、资源受限的现实情况，构建基于 OptaPlanner 多险情点多集结点资源领域模型，使用元启发式搜索算法（Meteheuristics，MH）对该领域模型进行求解，设定求解软硬约束，计算约束分数，求出绝对最优解。该模型能根据应急资源份额、险情事件等级、距离成本等对救援力量达到秒级分配。

​	基于以上研究内容，设计并实现了突发险情事件应急资源调配规划系统，其中包括系统框架设计、开发工具选择、项目结构设计、业务数据库设计和五个功能模块的详细设计与实现。最后，对两个核心功能模块测试，进行实验结果分析，验证系统在任务预案生成和应急资源调配规划方面具有优势。本系统可以提高面对突发险情事件时，救援的统筹、处置、响应能力。为我国政务部门大数据运转，信息化处理和应急决策提供理论依据和实现样例。

关键词：突发险情事件；数据仓库；规则引擎；案例推理；应急资源调配；规划系统

## Abstract

As my country enters the “14th Five-Year Plan” stage, there are higher requirements for government governance efficiency, resource allocation and utilization efficiency. It is necessary to make new improvements in efficiency and rationality of planning. For example, when social emergencies occur, it is very important for emergency management departments and rescue teams to allocate resources reasonably and deliver them to the corresponding places in a timely manner, and take quick and effective measures to reduce casualties and losses caused by dangerous situations. . Aiming at the core problems of high timeliness requirements for emergencies, weak overall rescue forces, few rescue forces, and complicated transfer and avoidance of dangers, this paper uses the metadata information of Guiyang Public Security Bureau, Human Resources and Social Security Bureau, Garrison District and other government departments to build a data warehouse, combined with According to the actual rescue needs of the emergency headquarters, the emergency resource allocation planning system for emergencies and dangerous events has been designed and implemented. The system can write and store the rules for dealing with dangerous situations, quickly analyze dangerous situations, generate emergency response task plans, allocate emergency resources, and plan the visual display of rescue plans.

The main research work of this paper is as follows:

 1) By analyzing the national emergency response mechanism for emergencies and dangerous events, using the Rule Engine Rule-Based Reasoning ( RBR) and Case-Based Reasoning  (CBR) technology, applied to the decision-making of emergency and dangerous events , use RBR to directly generate rescue plans or enhance the plans generated by CBR. This paper proposes a decision-making framework for sudden and dangerous events, and studies the representation of dangerous situations, the reuse of dangerous situations, the optimization of dangerous situations, and the learning of dangerous situations according to the decision-making process in the framework. According to the characteristics of sudden and dangerous events, in the stage of expressing dangerous situations, we use word segmentation and regular expression technology to analyze dangerous situations to make them structured, and use object-oriented knowledge to construct dangerous situation objects. Then, the conditions for dealing with dangerous situations are refined and sub-tasks are assigned to dangerous situations. This representation method can comprehensively describe the occurrence of emergencies and rescue conditions, which is beneficial to the generation of mission plans. In the dangerous situation reuse and optimization stage, the calculation formula of the similarity of dangerous situations and the construction method of the rule base are given, which can be displayed intuitively and quickly whether the user selects the similarity recommendation, or the rule recommendation method generates the task plan. Then, in the learning stage of dangerous situations, the completed task plans are summarized and iteratively changed into expert knowledge content to meet the scalability and professionalism of the system.

 2) In terms of emergency resource allocation, based on Massively Parallel Processor (MPP) database technology, according to the data resources of multiple government departments such as Guiyang Public Security Bureau, Human Resources and Social Security Bureau, and Garrison District, the Emergency Resource Data Warehouse(DW) is designed and established. . The Operational Data Store (ODS) of each department is Extract, Transform, and Load(ETL) code to form the relationship between dimension tables and fact tables in star schema. Through the processing process between different levels of the data warehouse, the transformation from data assets to information assets can be realized, which can respond to complex query situations and efficiently store and visualize emergency resource data.

 3) In the aspect of emergency resource planning, in the face of the reality of multiple target points, multiple rescue points and limited resources, build a resource domain model based on OptaPlanner with multiple danger points and multiple assembly points, and use the Meteheuristics search algorithm (MH) to The domain model is solved, the soft and hard constraints are set, the constraint scores are calculated, and the absolute optimal solution is obtained. The model can allocate rescue forces in seconds according to the share of emergency resources, the level of dangerous events, and the distance cost.

 Based on the above research content, an emergency resource allocation planning system for emergencies and dangerous events is designed and implemented, including system framework design, development tool selection, project structure design, business database design, and detailed design and implementation of five functional modules. Finally, the two core functional modules are tested, and the experimental results are analyzed to verify that the system has advantages in the generation of task plans and emergency resource allocation planning. This system can improve the overall planning, handling and response capabilities of rescue in the face of sudden and dangerous events. It provides theoretical basis and implementation examples for the operation of big data, information processing and emergency decision-making in my country's government affairs departments.



Key words: Public emergency,Data Warehouse, Rule engine, Case reasoning, Emergency resource allocation, Planning system

## 1 绪论

### 1.1 研究背景及意义

​	当发生自然灾害、事故灾难等重大突发险情事件时，应急救援部门的处理能力，响应机制、资源调度、投送方式衡量着一个城市数字信息化的程度及水平，是运用大数据和人工智能技术，解决现实问题能力体现。在重大突发险情事件发生时，救助体系建设完善，应急决策准确、物资人力统筹互通、解决时效快，对社会经济，人民安全方面发挥了重要作用。截止2021年，新冠疫情仍在肆虐，环境恶化、自然灾害等突发险情事件频发，对人民群众的生命财产造成了巨大损失，政府处理部门形成了巨大考验。

​	近些年，大数据建设如火如荼，尽管云上政务处理，城市数智化进程等方面取得一定成就。但对于突发事件应急管理总体来说，还是存在许多不足，如统筹抢险力量薄弱，人民转移避险难度大；社会救援力量少，抢险救灾时间紧[1]等。所以应急抢险存在的不足具体归纳为：

1. 社会应急资源数据，信息共享低，联动性差。突发险情事件应急的响应，需要使用政要部门的核心数据，协同人力、车辆、物资等进行救援，各部门的信息并不能快速融合调动，救援力量协调困难、衔接脱节。各部门互相之间参与度低，任务职责不明确，严重降低了应急救援效果。
2. 险情事件不固定，随机性高。当突发险情事件类型不同，情况不同，所需要生成的任务预案，参与救援部门、应急资源会随之有相应变化。险情事件格式不统一，往往是非结构化数据，会导致重点信息难以辨认。极大影响部门之间协同合作，造成资源调配规划失效等后果。
3. 依赖人工、领导过往经验生成救援任务预案。当前对于重大突发险情事件主要根据决策者的过往经验，人工观察规划，形成救援方案。但是突发事件具有强烈的环境不确定性、处理复杂性、救援急迫性等特征，需要决策者在信息不全面，参与救援力量庞杂等现实情况进行决策，所制定的方案难免存在缺陷。
4. 应急决策不及时，救援安排时间长。黄金救援时间点转瞬即逝，当存在多个需救援地点，如何从现存已有的资源中合理分配，达到瞬间响应完毕，进行规划，对于应急救援至关重要。救援届普遍认为：针对事故灾难，30-90分钟内救助，存活率高达80%[2]，针对自然灾害，前72小时救助，存活率依时间递减，90%至20%。因此突发事件发生后，及时对受灾人员施予搜索，救助至关重要。

​	因此，基于以上重大突发险情事件应急救援存在的主要问题，设计并实现一款基于规则引擎的应急资源调度规划系统。针对数据信息共享低，联动性差问题，融合多数据源，规范ETL过程，设计出维度、事实表关系的星型模式，搭建了应急资源数据仓库，可以统筹抢险力量，发挥应急救援的综合优势。针对险情不固定性，随机性高问题，通过分词工作，结合词频关键词统计与正则表达式方法，提取出险情对象，以及所对应相关子任务，运用面向对象技巧，对象化险情，从非结构化的险情信息，变成清晰明了的险情对象。针对依赖人工、领导经验生成救援任务问题，系统通过分析与处理已存储的规则和案例，提取数据仓库信息方式，快速地辅助救援部门制定救援任务预案，强化重点区域救援力量前置布防。针对决策不及时的问题，运用元启发式搜索算法，在多目标点多救援点，限制条件下也有最优规划方案，并且时效性足够高，再通过可视化内容，展示合理、有效地分配应急资源， 加强协调联动，积极引导社会救援力量参与抢险救灾。

​	综上所述，本文对以上内容，展开了研究。

### 1.2 国内外研究现状

#### 1.2.2 基于规则引擎的调配研究现状

规则引擎研究现状

#### 1.2.1 应急资源调配规划研究现状

规划算法研究现状

#### 1.2.3 应急资源调配规划系统研究现状

系统研究研究现状

### 1.3 研究内容和章节安排

​	本文研究的主要内容共八个部分。具体章节安排为：

​	第一章阐述了基于规则引擎的应急资源调配规划系统的研究背景，现阶段国内外研究现状和存在的问题，进而引出了本文的研究内容，论文章节安排，最后讲述了论文的创新点。

​	第二章分析了重大突发险情事件的定义、分类分级、响应，并对应急决策准备体系、资源种类与用途、调配流程展开了说明。

​	第三章对数据仓库设计和实现进行了详细介绍。依据 Kimball DW/BI建模思路，设计应急资源数据仓库模型，融合了多数据源，由无到有，从ODS开始，经过ETL，设计公共维度表和事实表，最终搭建了应急资源数据仓库，满足快速响应资源查询和可视化效果。

​	第四章基于规则引擎，使用RBR与CBR技术，对重大突发险情事件中，应急决策相关理论展开研究，提出了突发险情事件中，应急资源调配框架与流程，并在CBR基础上结合RBR对险情案例表示、重用、优化、学习分别展开了研究。

​	第五章基于规划引擎，对应急资源规划的基本理论展开了研究，建立了应急资源规划领域模型，分别阐述了领域模型设计，模型求解器配置，模型实现三个方面内容。

​	第六章根据以上的研究思想，设计并实现了应急资源调配规划系统，内容包含系统框架设计、开发工具选择、项目结构设计、业务数据库设计和五个功能模块的设计与实现。

​	第七章对系统两个核心功能模块分别进行了测试，进行结果分析，满足了对系统的响应迅速，稳定易用要求。

​	结论部分进行了论文工作总结。汇总本文的工作成果，思考系统的不足之处，并对后续的系统迭代工作进行展望。



### 1.4 论文创新点

1. 搭建了应急资源数据仓库。分析应急救援任务中数据信息共享低，联动差问题，结合险情应急决策需求，对贵阳市公安局，人社局，警备区等政府部门的大量操作性源数据，进行ETL处理，规范化数据格式，统一不同表之间元数据，划分数据域，明确应急救援业务过程，细粒化声明，确定一致性维度，维度表，事实表，通过维度退化，派生指标、缓慢维度变化等一系列操作，建立维度表与事实表的星型模式关系。
2. 提出了基于规则引擎，在CBR基础上结合RBR的突发险情事件应急资源调配框架与流程。对突发险情事件进行分词与正则化解析，使得非结构化险情，对象化，并且划分险情子任务，按需开展相关救援任务。在险情对象表示中，分为公有属性，以及针对不同类型险情的专有属性，建立案例解析、属性权重分析计算和规则定义方法论，满足案例重用和优化效果。
3. 建立了多险情点多救援点的应急资源规划领域模型，该模型使用元启发式搜索算法，根据领域模型中成本、突发险情等级、应急资源需求等约束条件，设计软硬约束，求出约束分数最低方案，即为最优解的求解，该算法相比其他搜索算法在收敛时间，约束成绩上具有优势。并且让领域模型融入系统中，设计和实现了应急资源调配规划系统，包括系统框架设计、结构设计、业务数据库设计和功能模块设计与实现。

## 2 突发险情事件与应急决策理论

​	本章主要介绍险情事件定义、分类分级、响应和应急决策的相关理论知识。具体介绍了四类突发险情事件，等级从Ⅰ到Ⅳ变化，以及事件响应内容。对于应急决策，阐述了准备体系，多政府部门提供的资源种类和用途，救援的准备，和决策流程。为后续章节中数据仓库建设、应急资源调配，规划、系统开发提供理论依据和研究方向。

### 2.1 突发险情事件

#### 2.1.1 突发险情事件定义

​	突发险情事件是指突然发生，造成或者可能造成重大人员伤亡、财产损失、生态环境破坏和严重社会危害，危及公共安全，需要采取应急处置措施予以应对的事件。

#### 2.1.2 突发险情事件分类

​	突发险情事件主要分为以下四类：自然灾害，事故灾难，公共卫生事件、社会安全事件，如图 2.1 所示：

<img src="/Users/yuanye/Desktop/险情分类截屏.png" alt="险情分类截屏" style="zoom:30%;" />

 <center><p>图 2.1 突发险情事件分类 </p></center>

​	自然灾害：自然灾害可分为洪涝灾害，干旱灾害，暴雨灾害，地质灾害，海洋灾害，生物灾害和森林草原火灾等。

​	事故灾难：由人为因素过失所导致的灾难，主要包括工矿商贸等企业的各类安全事故，交通运输事故，公共设备设施和消防事故，危险化学品爆炸与泄漏事件等。

​	公共卫生事件：主要包括传染病疫情，群体性不明原因疾病，食品安全和职业危害，动物疫情，以及其他严重影响公众健康和生命安全的事件。

​	社会安全事件：主要有群体性事件，经济安全事件和涉外突发事件等。

#### 2.1.3 突发险情事件分级响应

##### 2.1.3.1 事件分级

​	由国务院发布的《国家突发公共事件总体应急预案》中对可能发生的突发险情事件进行分级。依据突发险情事件可能造成的危害程度、紧急程度和发展势态，一般划分为四级：Ⅰ级（特别严重）、Ⅱ级（严重）、Ⅲ级（较重）和Ⅳ级（一般），依次用红色、橙色、黄色和蓝色表示。

##### 2.1.3.2 事件响应

​	以自然灾害为例，在国务院依据"三定"规定及国家有关救灾工作方针、政策和原则制定的《国家自然灾害救助应急预案》表示，按照"条块结合，以块为主"的原则，灾害救助工作以地方政府为主。灾害发生后，政府相关部门要根据灾情，按照分级管理、各司其职的原则，启动相关层级和相关部门应急预案，做好灾民紧急转移安置和生活安排工作，做好抗灾救灾工作，做好灾害监测、灾情调查、评估和报告工作，最大程度地减少人民群众生命和财产损失。

​	根据突发性自然灾害的危害程度等因素，国家设定四个响应等级，从高到低：Ⅰ级响应，Ⅱ级响应，Ⅲ级响应，Ⅳ级响应。响应流程图如下2.2所示：

<img src="/Users/yuanye/Desktop/响应流程.png" alt="响应流程" style="zoom:35%;float: center;"/>

 <center><p>图 2.2 险情响应流程图 </p></center>

​	事件响应流程，从事发地点报警接警开始，由应指挥机构等联动部门进行先期处置，事件上报给市县应急指挥中心，如果判断事件等级为Ⅲ、Ⅳ级，即让市县应急指挥中心自行启动地方应急预案，进行处理。若是事件在发生变化，等级升级，则启动省级应急预案，迅速成立省级指挥部，开展应急处置各项工作，直到应急结束，最后则为善后及重建工作。本系统主要简化了响应流程中的线下操作，以数据流通，信息化方式完成险情响应线上操作，智能化、合理地安排应急处置中各项步骤。

### 2.2 应急决策

#### 2.2.1 应急决策准备体系

​	为了方便理解，险情地点以贵阳，险情类型以自然灾害为例，应急决策准备体系如图2.3所示：

<img src="/Users/yuanye/Desktop/准备体系.png" alt="准备体系" style="zoom:50%;float:center" />

 <center><p>图 2.3 应急决策准备体系 </p></center>

1. 应急指挥中心：根据突发险情事件的等级制度，由国务院或当地政府部门成立应急指挥中心，统筹规划。建立由应急指挥中心统一领导，调度、多部门多资源参与的应急响应、协同合作机制。
2. 资金准备：应急指挥中心根据险情地点受灾程度，安排救灾资金预算，调配整合。民政局、市检局给予资金资源信息，以地方为主，按照救灾工作分级负责，救灾资金分级负担的原则，开展资金准备工作。当救灾预算资金不足时，调度中央和地方各级财政安排的预备费用。
3. 物资准备：整合各部门现有救灾储备物资和储备库规划，分级分类管理储备救灾物资，准备好救灾帐篷、衣被、净水、医疗设备等救灾物资。直辖市及灾害多发地、县建立健全物资储备库。市检局提供救助物资生产厂家名录，必要时签订救灾物资紧急购销协议。
4. 通信和信息准备：人防办部门派遣工程人防队伍，通信专家。应依法保障灾害信息的畅通，自然灾害救助信息网络应以公用通信网为基础，合理组建灾害信息专用通信网络，确保信息畅通。
5. 救灾装备准备：应急指挥中心根据已有资源数据情况，配备救灾管理工作必需的设备和装备。民政部、运管局、卫健局及人防办应配备救灾必需的运输车辆、重型设备、医疗队伍和专业人防队伍。
6. 人力资源准备：根据公安局、人社局、教育局、警备区等数据信息，组织完善灾害管理人员队伍建设，提高其应对自然灾害的能力。建立政治动员专业人才、专家队伍。建立健全与运管局、警备区、退役军人事务局等专业救援队伍的联动机制。
7. 社会动员准备：应急指挥中心调配、安排非政府组织和社会动员队伍，并充分发挥其作用。并应建立和完善企业捐助的动员机制、运行机制、监督管理机制，规范突发自然灾害社会捐助工作。



#### 2.2.2 应急资源种类与用途

​	突发险情事件救援资源主要为数据仓库存储资源，来源于公安局、人社局、残联、民政局、卫检局、教育局、警备区、事务局、市监局、人防办多个部门源数据库，统一规范化，经过清洗，转化，加载到数据仓库。庞杂繁多，未经处理的数据经过精简后成为可分配，可量化、应急资源，提供给系统调度。

1. 公安局：提供常住人口，驾驶员信息，用以人力资源准备、社会动员准备。
2. 人社局：提供单位及个人信息，开展物资、人力资源准备。
3. 残联：提供残疾人信息，用以筛选及排查人力资源。
4. 民政局：提供婚姻信息、死亡信息，政治动员专业人才，加强促进于应急指挥中心建立，通信和信息、人力资源，社会动员等工作。
5. 卫检局：提供医务人员信息、医院和医疗物资信息，拥有医生，护士、救护车、医疗资源等救灾装备，物资准备。
6. 教育局：提供注册学籍信息，方便人力资源准备和社会动员准备。
7. 警备区，事务局：提供大学生兵役登记，民兵、退役军人信息，支持通信和信息、人力资源、社会动员准备。
8. 运管局：提供运输车辆及驾驶人，重型设备信息，满足物资、救灾装备准备。
9. 市监局：提供企业基本信息，运输企业、重型设备企业信息，作用于资金、物资准备、救灾装备和社会动员等方面。
10. 人防办：提供重要目标、专业队伍、防空工程、隐蔽地域信息，提升应急指挥中心进行物资、救灾装备等调配速度。

#### 2.2.3 应急决策流程

​	应急决策按照险情行进过程的状态来划分，可分为四个阶段：险情确认阶段、险情响应阶段、险情处理阶段、险情后续阶段，如下图2.4所示：

<img src="/Users/yuanye/Desktop/应急决策流程.png" alt="应急决策流程" style="zoom:60%;float:center" />

 <center><p>图 2.4 应急决策流程 </p></center>

1. 险情确认阶段

   ​	突发险情事件发生至确认发生这一时间段，通过情况下，发生到确认险情等级时间不会太长。主要的确认方式有，天眼系统监控、相关部门预警、监控卫星、突发险情报警以及求助电话、应急指挥机构的先期处置报告。

2. 险情响应阶段

   ​	突发险情事件确认后，由应急指挥中心根据险情事件的等级、类型和严重程度等启动相应的应急措施，调配相关资源，通知救援部门开展救援行动。险情事件确认后至应急指挥中心开展救援这一阶段为险情响应阶段，若是做到合理的应急资源调配，及救援方案规划，可以减少响应阶段花费时间。

3. 险情处理阶段

   ​	险情处理阶段是指救援行动到达险情发生点至险情处理结束，即将开展险情评估阶段。应急指挥中心依据技术手段和数据信息，协调好各部门分工，适配救援资源，做出正确的应急决策能够减少险情事件带来的损失。

4. 险情后续阶段

   ​	对于险情完毕和评估后，总结险情发生的原因，责任的追究，整体的评价，还有此次应急决策存在的不足，能够改进的方面。

### 2.3 本章小结

​	本章讲述了突发险情事件的定义、类别和级别，对于应急决策准备体系、决策流程，应急资源情况等方面展开研究，定下后续章节的研究基调。同时，规定下文险情地点在贵阳，险情类型以自然灾害为例。



## 3 应急资源数据仓库

​	通过对应急决策准备体系、应急资源内容的研究，以及相关政府部门数据支持，发现政府部门间源数据存在格式、解释性，可扩展性差、冗余高、完整性缺失，文档不齐全等问题，需要对政府数据提出进一步要求。在应急救援中，数据流转至关重要，影响着决策可靠性、救援时效性、资源分配合理性。因此着手建立应急资源数据仓库（下文以 ER-DW 指代），本文中 ER-DW 基于 Kimball DW/BI 架构设计[]，如图3.1所示：

<img src="/Users/yuanye/Desktop/ER-DW架构.png" alt="Kimball DW:BI" style="zoom:50%;" />

 <center><p>图 3.1 ER-DW 架构 </p></center>

​	首先，ER-DW 从不同政府部门间，由源数据库 ODS 开始，提取关键人、物、力数据，然后经过ETL处理和规范、保障数据完整性及一致性，构建与加载维度表和事实表到维度模型（采用星型模式）中，最后满足查询、可视化、应急资源调配和规划需求。ER-DW 有灵活性、扩展性、高性能等特点，可以进行有效的数据质量处理，支撑着险情事件中应急决策。

### 3.1 ER-DW 架构

#### 3.1.1 ODS

​	ODS 为操作型系统数据层，该层存储的是各部门日常政务处理业务和事务数据，作为数据库到数据仓库的一种过渡形式，与数据仓库在物理结构上不同。其中的数据格式和内容无法控制，提供即时性的、操作性的、集成的全体信息的需求，是后续数据仓库加工数据的来源。

#### 3.1.2 ETL

​	ETL 加工 ODS 传来的数据，其过程是将不同业务系统中存在的数据，获取、清洗、转化后加载数据仓库环境。目的在于解决“数据孤岛”问题，将杂乱、分散、无规范的数据进行处理，增加数据的利用价值。ETL过程是数据仓库构建的必须过程[]，也是应急资源调配规划系统重要的一步。ETL涉及三个步骤，如图3.2所示：

<img src="/Users/yuanye/Desktop/ETL 过程.png" alt="ETL 过程" style="zoom:75%;" />

 <center><p>图 3.2 ETL 过程示意图 </p></center>

数据获取：从各个政府部门业务系统中抽取，标准不同且分散的数据，意味着读取并理解源数据信息，并将需要的数据复制到ETL过程。在这一过程中，可以对数据适当进行清洗和转换操作，提高数据获取效率。

数据转换：数据到达 ETL 过程后，需要进行多种转换操作，比如：清洗数据（消除拼写错误、解决冲突、处理错误信息、解析为标准格式），合并来自不同数据源的数据，复制数据等。数据转换目的为根据数据规范定义，进行数据的一致性、细粒度、完整性的转化。

数据加载：数据被获取、转换完成后，实际构建和加载数据到目标维度模型过程。数据加载的主要任务是在交付过程中划分维度和事实，比如：代理键分配，拆分或组合列以提供适当的数据值，降低数据范式等，对ER-DW十分重要，

#### 3.1.3 DW

​	DW存放一致性维度表、一致性事实表，组成了星型模式的维度模型。本层用于组织、存放数据，支持用户、系统的查询，包含详细的原子数据，满足无法预期、随机组合的查询，提供聚集、下钻、上卷等效果以解决实际问题。

##### 3.1.3.1 一致性维度表：

​	维度是维度建模灵魂，在维度建模中，将环境描述为“维度”，维度适用于分析事实所需要的多样环境。比如说：在应急救援过程中，可以通过公安、民政、运管和人防部门等维度描述应急救援发生的环境。维度表所包含的表示维度的列，称为维度属性，其是查询约束条件、分组和报表标签生成的基本来源，是数据易用性的关键。维度表构造关键有自然键/代理键，规范化/反规范化，缓慢变化维度：

​	**自然键/代理键：**维度表使用主键表示其唯一性，主键也是确保与之相连的任何事实表之间存在引用完整性的基础。主键分为自然键和代理键，用于表示维度的具体值。代理键是不含义务含义的键，用于处理缓慢变化维度；自然键是具有业务含义的键。比如企业，在ETL过程中，对于企业维度表的每一行，可以生成一个唯一的代理键与之对应，而企业本身的自然键是企业统一社会信用代码。

​	**规范化/反规范化：**维度设计者，需要抵制多年来操作型数据库设计所带来的数据库范式要求，并讲非规范化的多对一固定深度层次引入扁平维度行的不同属性。非规范化维度能够实现维度建模的双重目标：简化及速度。反规范化的维度，从分析角度来看，没有丢失任何信息，但复杂度降低了。

​	**缓慢变化维度：**处理维度的变化是维度设计的重要工作。缓慢变化维度的提出是因为在现实世界中，维度的属性并不是静态的，它会随着时间的流逝发生缓慢的变化。主要有三种方式：1.重写维度值，也即是ER-DW采取的方法，因为要保证应急资源的唯一性，采用此种方式，不保留历史数据，始终获取最新数据。2.插入新的维度行 3.添加维度列。

##### 3.1.3.2 一致性事实表：

​	在维度建模中，将度量称为“事实”，事实表作为维度建模的核心，紧紧围绕着应急救援过程来设计，通过获取描述应急救援中的度量来表达应急救援过程，包含了引用的维度和与应急救援过程有关的度量。事实表中一条记录所表达的业务细节程度被称为粒度，简单来说，就是维度属性组合所表示的细节程度，相对维度表来说，事实表要细长得多。事实表构建关键有事务事实表，可加、半可加、不可加性，退化维度，且依照事实完整、一致、可加性设计准则：

​	**事务事实表：**事务事实表用来描述应急调配过程，跟踪空间或时间上某点的度量事件，保存的是最原子的数据。

​	**可加、半可加、不可加：**可加性指按照与事实表关联的任意维度进行汇总，半可加性只能按照特定维度汇总，还有一种度量不完全具备可加性，如比例率。

​	**退化维度：**维度属性也可以存储到事实表中，这种存储到事实表中的的维度列被称为”退化维度“。与其他存储在维度表中的维度一样，退化维度可以用来进行事实表的过滤查询、实现聚合操作等。

​	**事实完整性：**事实表包含与其描述的过程有关的所有事实，即尽可能多地获取所有的度量。

​	**事实一致性：**在确认事务事实表的事实时，明确存储每一个事实以确保度量的一致性。

​	**事实可加性：**事实表确认事实时，可能会遇到非可加性度量，比如比例，利率等，可作为分析点。但事实表应关注更多是可加性事实，让应急资源调度中聚合统计更加方便。

#### 3.1.4 BI

​	BI层主要泛指为应急资源调度规划系统，提供制定应急救援决策能力。根据定义，所有BI应用的查询针对DW层，查询时使用数据提高决策能力的关键。对于大多数突发险情事件，应急救援可以通过预先构建CBR和RBR对应任务规则和模版，进行数据访问，不需要直接构建查询，以及对于应急资源规划，数据直接响应至领域模型中，得到快速规划与良好展示的效果。



### 3.2 ER-DW 实施

#### 3.2.1 实施工作流

​	依照上文ER-DW架构设计，实施工作流，开展ER-DW的实现。实施工作流如图3.3所示

<img src="/Users/yuanye/Desktop/ER-DW实施流程.png" alt="ER-DW实施流程" style="zoom:80%;" />

 <center><p>图 3.3 ER-DW 实施工作流 </p></center>

​	首先，在建设ER-DW时，要进行充分的系统业务调研和需求分析。这是数据仓库建设的基石，业务调研和需求分析做的充分直接决定了数据仓库建设是否成功。其次，数据域和总线矩阵方面，主要是根据数据域对数据进行划分；按照维度建模理论，构建总线矩阵、抽象出救援过程和维度。再次，ER-DW核心部分，完成规范定义和模型设计与实现。最后，就是开发部署运维工作。本节重要讲解开发部署运维，之前步骤的内容。

#### 3.2.2 数据调研

##### 3.2.1 任务调研

​	任务调研 如表3.1所示

| 任务/险情事件 | 自然灾害 | 事故灾难 | 公共卫生事件 | 社会安全事件 |
| ------------- | -------- | -------- | ------------ | ------------ |
| 社会动员      | √        | √        | √            | √            |
| 治安维护      | √        | √        | √            | √            |
| 医疗救护      | √        | √        | √            | √            |
| 卫生保障      | √        | √        | √            | N/A          |
| 专业人才      | √        | √        | √            | √            |
| 紧急驾驶      | √        | √        | √            | N/A          |
| 物资保障      | √        | √        | √            | √            |
| 重型设备      | √        | √        | N/A          | N/A          |
| 饮食保障      | √        | √        | √            | √            |
| 生活保障      | √        | √        | √            | N/A          |
| 紧急运输      | √        | √        | √            | √            |
| 人员搜救      | √        | √        | √            | √            |
| 人员庇护      | √        | N/A      | √            | √            |
| 专业队伍      | √        | √        | √            | √            |
| 通信保障      | √        | √        | √            | √            |

##### 3.2.2 需求分析

​	需求分析 如表3.2

| 任务/行动 | 救援动作 |
| :-------- | :------- |
| 社会动员  |          |
| 治安维护  |          |
| 医疗救护  |          |
| 卫生保障  |          |
| 专业人才  |          |
| 紧急驾驶  |          |
| 物资保障  |          |
| 重型设备  |          |
| 饮食保障  |          |
| 生活保障  |          |
| 紧急运输  |          |
| 人员搜救  |          |
| 人员庇护  |          |
| 专业队伍  |          |
| 通信保障  |          |



#### 3.2.3 数据域和总线矩阵

##### 3.3.1 数据域划分

操作型系统-源数据表



根据数据及业务调研，需求分析，划分数据域为表3.3

| 数据域     | 救援过程举例 |
| ---------- | ------------ |
| 人力资源域 |              |
| 企业资源域 |              |
| 人防资源域 |              |



##### 3.3.2 总线矩阵设计

总线矩阵 图3.4

![image-20220307220253544](/Users/yuanye/Library/Application Support/typora-user-images/image-20220307220253544.png)

#### 3.2.4 规范定义

主要定义指标体系，维度、度量/原子指标、包括原子指标、修饰词、时间周期和派生指标

ETL 清洗 汇总 指标 命名等规范

自然键，代理键



#### 3.2.5 维度模型设计与实现

##### 3.5.1 业务过程

人力资源业务过程

企业资源业务过程

人防资源业务过程

##### 3.5.2 声明粒度

人

企业

人防

##### 3.5.1 维度表设计

讲解 源表划分为维度表

##### 3.5.2 事实表设计

讲解维度表 融合成事实表

##### 3.5.3 构建星型模式

星型图

### 3.6 本章小结

​	讲下本数据仓库的优点



## 4 基于规则引擎的应急资源调配研究

### 4.1 规则引擎技术

#### 4.1.1案例推理技术



#### 4.1.2 规则推理技术

![image-20220301170219008](/Users/yuanye/Library/Application Support/typora-user-images/image-20220301170219008.png)

规则流程图 以及作用

### 4.2 突发险情事件应急资源调配框架与流程

#### 4.2.1 应急资源调配框架



#### 4.2.2 应急资源调配流程



### 4.3 规则库

#### 4.3.1 专家知识的获取

选择标准

#### 4.3.2 专家知识的表示

规则表示的详细结构

#### 4.3.3 规则库的建立

险情规则库

险情+标准图

子任务规则库

属性+任务图

### 4.4 突发险情事件案例表示

#### 4.4.1 险情结构化

##### 4.4.1.1 读取并预处理



##### 4.4.1.2 词频统计



##### 4.4.1.3 关键词提取



##### 4.4.1.4 正则表达式

**编写目的**



**编写样式**



**查准率与查全率**

在信息检索领域，精确率和召回率又被称为查准率和查全率，

查准率 = 提取出的正确信息条数 / 提取出的信息条数

查全率 = 提取出的正确信息条数 / 样本中的信息条数

召回率，是指通过正则表达式在数据集内进行匹配，所匹配到的正类结果数与数据集中实际 正类数的比率。相对而言，召回率越高，漏匹配的数据就越少。
$$
\Large 召回率 = \frac{将正类预测为正类}{原本的正类}
$$


精确率，是指正则表达式预测为正类的结果中，的确为正类的结果所占的比率。相对而言， 精确率越高，匹配到的错误结果将越少。
$$
\Large 精确率 = \frac{将正类预测为正类}{预测的正类}
$$

##### 4.4.1.5 可视化显示及修正



#### 4.4.2 险情问题描述域

##### 公有属性

##### 专有属性



#### 4.4.3 险情解决策略域

子任务 

子任务-事实表 贴合执行操作及数据

#### 4.4.4 险情执行效果域

另生成业务表显示执行效果



### 4.5 突发险情事件案例重用

4.5.1 AHP权重确认

4.5.2 相似度计算

4.5.2.1 局部相似度

4.5.2.2 总体相似度

### 4.6 突发险情事件案例优化

4.6.1 任务生成方法

相似推荐

规则推荐

4.6.2 任务优化方法

4.6.3 任务优化流程

4.6.4 规则库建立

### 4.7 突发险情事件案例学习



### 4.8 本章小结

 ## 5 应急资源规划研究

任务快速调度至集结、事件点

### 5.1 应急资源规划模型设计

#### 5.1.1 多突发事件点多集结点的应急资源规划关系

#### 5.1.2 基于 OptaPlanner 的应急资源规划模型

算法及规模

1. Scale out: Large production data sets must not crash and have also good results.
2. Optimize the right problem: The constraints must match the actual business needs.
3. Available time: The solution must be found in time, before it becomes useless to execute.
4. Reliability: Every data set must have at least a decent result (better than a human planner).

### 5.2 应急资源规划领域模型

#### 5.2.1 领域模型设计

#### 5.2.2 领域模型求解器配置

##### 5.2.2.1 领域模型配置

##### 5.2.2.2 约束资源配置

1. 硬约束
2. 软约束

##### 5.2.2.3 优化算法配置



### 5.3 领域模型实现

##### 

### 5.4 本章小结



## 6 应急资源调配规划系统

### 6.1 系统框架设计

### 6.2 系统开发工具选择

#### 6.2.1 前端开发工具

#### 6.2.2 SpringBoot 开发框架

#### 6.2.3 Echart 可视化工具

#### 6.2.4 高德地图 API

#### 6.2.5 Drools 规则引擎

### 6.3 系统项目结构设计



### 6.4 系统业务数据库设计

### 6.5 系统功能设计与实现

#### 6.5.1 功能及接口设计

#### 6.5.2 用户管理模块功能实现

#### 6.5.3 数据管理模块功能实现

#### 6.5.4 规则库模块功能实现

#### 6.5.5 解析调度模块功能实现

##### 6.5.5.1 险情事件管理

##### 6.5.5.1 调配规划管理

#### 6.5.6 可视化模块功能实现

### 6.6 本章小结

## 7 应急资源调配规划系统测试

### 7.1 险情解析及任务预案生成测试

#### 7.1.1 有相似历史险情情况

1. 险情解析
2. APH检索
3. 子任务生成

#### 7.1.2 无相似历史险情情况

#### 7.1.3 实验结果分析

### 7.2 应急资源调配规划测试

#### 7.2.1 案例假设

#### 7.2.2 求解结果分析

#### 7.2.3 调配规划方案显示

### 7.3 本章小结

## 结论



## 参考文献



## 在学研究成果



## 致	谢

